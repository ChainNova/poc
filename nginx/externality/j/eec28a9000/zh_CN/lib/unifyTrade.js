define(["lib/BN"],function(e){var n={};return n.txSuccess=function(e){var n=e.meta,t=e.transaction;if(n&&t&&"tesSUCCESS"==n.TransactionResult)return~["Payment","OfferCreate","OfferCancel"].indexOf(t.TransactionType)},n.mergeOffers=function(n,t){["asks","bids"].forEach(function(i){var r=n[i],s=t[i.substring(0,i.length-1)],c=function(){if(!r.length)return[].push.apply(r,s)};if(!c()){for(var a="count",f=0;f<r.length;f++){var o=r[f],u=new e(o.showPrice),l=null;if(s.some(function(e,n){if(0===u.cmp(e.showPrice))return l=s.splice(n,1)[0]}),l){var m=new e(l[a]).cmp(o[a]);angular.merge(o,l),m>0?(o.act="up",o.time=CORE.ts()):m<0?(o.act="down",o.time=CORE.ts()):o.act&&o.time&&CORE.ts()-o.time>6e4&&(o.act="",o.time=0)}else r.splice(f--,1)}c()||s.length&&s.map(function(n){var t=new e(n.showPrice),s=r.length-1;r.some(function(e,c){var a=t.cmp(e.showPrice);return"bids"==i&&a>0||"asks"==i&&a<0?r.splice(c,0,n):c==s?r.push(n):void 0})})}})},n});