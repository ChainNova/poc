define(["common/module","common/locales","services/balance"],function(n,r){var e,o,u;return e=CORE.api.trade,o=r.get(),u=location.origin+"/passport/?passport=login",n.factory("ppServ",["ajax","$location","balanceServ",function(n,r,s){var t,c;return t=function(){return r.search().c},c={headers:{"content-type":"application/json"}},{login:function(r,o){var u;return u={enrollId:r.uname,enrollSecret:r.pwd},n.post(e+"login",u,c).success(function(n){return Const.justlogin=!0,angular.merge(Const.user,n.userInfo),s.empty(),o(n)}).error(function(n){return o(null,n)})},signup:function(r,s){var t;return t={json:{username:r.uname,password:r.pwd,pay_pwd:r.pay_pwd,email:r.email},lan:o,withCredentials:!0,seed:r.seed,callback:u},(r.verifyCode||r.phoneNumber)&&(t.json.verifyCode=r.verifyCode,t.json.phoneNumber=r.phoneNumber,t.json.phoneCode=r.phoneCode),n.post(e+"user/register",CORE.j2q(t)).success(function(n){return Const.justlogin=!0,Const.user=n.userInfo,s(n)}).error(function(n){return s(null,n)})},activateEmail:function(r,s){var t;return t=CORE.j2q({email:r,lan:o,callback:u}),n.get(e+"user/send_activated_mail?"+t).success(function(n){return s(n)}).error(function(n){return s(null,n)})},recoveryGetVerifyCode:function(r,o){var u;return u=CORE.j2q({nick:r.uname}),n.post(e+"user/send_sms_verify_code?"+u).success(function(n){return o(n)}).error(function(n){return o(null,n)})},recoveryByEmail:function(r,u){var s;return s={nick:r.uname,lan:o},r.gcode&&(s.payPassword=r.gcode),n.post(e+"user/forgot_password",CORE.j2q(s)).success(function(n){return u(n)}).error(function(n){return u(null,n)})},recoveryBySms:function(r,u){var s;return s={nick:r.uname,verifyCode:r.vcode,newPassword:r.pwd,lan:o},n.post(e+"user/reset_password_phone",CORE.j2q(s)).success(function(n){return u(n)}).error(function(n){return u(null,n)})},resetByEmail:function(r,o,u){var s;return s=CORE.j2q({token:r,newPassword:o}),n.post(e+"user/reset_password_email",s).success(function(n){return u(n)}).error(function(n){return u(null,n)})},userUnlock:function(r,o,u){var s;return r=r||"",s=CORE.j2q({password:o,password_pay:r}),n.post(e+"user/unlock",s).success(function(n){return u(n)}).error(function(n){return u(null,n)})},sendSms:function(r,o,u){var s;return s=CORE.j2q({nick:r,receiveType:o}),n.post(e+"user/send_sms_verify_code?"+s).success(function(n){return u(n)}).error(function(n){return u(null,n)})},sendCloseSMSEmail:function(r){return n.get(e+"user/send_close_dynamic_password_mail?lan="+o).success(function(n){return r(n)}).error(function(n){return r(null,n)})},checkUserUnlock:function(r){return n.get(e+"user/check_unlock").success(function(n){return r(n)}).error(function(n){return r(null,n)})}}}])});