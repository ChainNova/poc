define(["common/module"],function(e){var c,a;return c=CORE.api.trade,a={headers:{"content-type":"application/json"}},e.factory("historyServ",["ajax","$rootScope","$timeout",function(e,a,n){var r,t,s;return r=["held","deal","expire","cancelled"],t={exchange_buy:{icon:"ico_4",val:"exchange_buy",text:"买入"},exchange_sell:{icon:"ico_4",val:"exchange_sell",text:"卖出"},exchange_cancel:{icon:"ico_5",val:"exchange_cancel",text:"取消"},currency_create:{icon:"ico_2",val:"currency_create",text:"创建货币"},currency_release:{icon:"ico_6",val:"currency_release",text:"增发"},issue_assign:{icon:"ico_3",val:"issue_assign",text:"派发"},issue_received:{icon:"ico_1",val:"issue_received",text:"收到"},unknown:{icon:"ico_8",val:"unknown",text:"未知"}},s=function(e){var c,a,n,s;n=e.historys;for(a in n){switch(s=n[a],c=null,s.type){case"Exchange":c="exchange_"+(s.data.isBuyAll?"buy":"sell"),s._status=r[s.data.status],s.taker_gets=s.data.isBuyAll?{amount:s.data.desCount,currency:s.data.desCurrency}:{amount:s.data.srcCount,currency:s.data.srcCurrency},s.taker_pays=s.data.isBuyAll?{amount:s.data.srcCount,currency:s.data.srcCurrency}:{amount:s.data.desCount,currency:s.data.desCurrency};break;case"AssignCurrency_MeTo":c="issue_assign";break;case"AssignCurrency_ToMe":c="issue_received";break;case"CreateCurrency":c="currency_create";break;case"ReleaseCurrency":c="currency_release";break;default:c="unknown"}s._type=t[c]}return e},{history:function(a){return e.get(c+"history").success(function(e){return a(s(e))}).error(function(e){return a(null,e)})}}}])});