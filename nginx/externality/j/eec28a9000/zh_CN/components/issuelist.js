define(["common/module","jade!tmpl/issuelist","jade!tmpl/issue/new","services/issue"],function(n,e,r){var u;return u={issues:[]},n.directive("ngdIssueList",["$location","issueServ","$timeout","$dialog",function(n,t,c,s){return{restrict:"E",transclude:!0,template:e,link:function(n,e,i,o){var a,l,m,d;return n.IssueData=u,l=null,m=function(n){return u.pending=!0,t.issues(function(e,r){var t;return u.pending=!1,r?CORE.msg(r.error_msg,"warn"):(null!=(t=e.currencys)&&t.map(function(n){return n.color="#fce0ca"}),u.issues=n?u.issues.concat(e.currencys):e.currencys)})},m(),d=null,a=function(n){return c.cancel(d),d=c(m,n||1e3)},n.newCurrency=function(){return l=s.open({title:"发行货币",classname:"dialog3",template:r,scope:n,controller:["$scope",function(e){return e.newCurrencyData={},e.mkNew=function(){var r;return r={id:e.newCurrencyData.currency,count:e.newCurrencyData.amount},n.pending=!0,t.newCurrency(r,function(e,r){return n.pending=!1,r?CORE.msg(r.error_msg,"warn"):(l.close(),a())})}}]})},n.$on("issueUpdateSuccuess",function(){return a()})}}}])});