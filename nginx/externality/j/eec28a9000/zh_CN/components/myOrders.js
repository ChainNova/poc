define(["common/module","jade!tmpl/myOrders","services/fast","services/coin"],function(r,e){return r.directive("ngdMyOrders",["fastServ","$rootScope","coinServ",function(r,n,t){return{scope:{showType:"@ngdMyOrdersType"},restrict:"A",transclude:!0,template:e,link:function(e,c,u,i){var y;return e.fast=y=n.fast,e.type=e.showType?e.showType:"held",e.show_all=!0,e.currentSel={pair:y.pair},e.bn_div=function(r,e,n){return new BN(r).div(e).toString()},e.changeFilterShow=function(r){return e.show_all=!e.show_all},e.cancel_order=function(e){return e.pending=!0,r.cancelOffer(e.uuid,function(r,n){return e.pending=!1,n?CORE.msg(n.error_msg,"warn"):e.cancelled=!0})},e.chgType=function(r){if(e.type=r,"dealt"===r)return e.myOrders.dealtNew=0},e.$watch("type",function(n){if(n)return e.myOrders=r.myOrders(n)}),e._sortBy="_price",e._sortReverse=!0,e.mySortBy=function(r){return e._sortReverse=e._sortBy===r&&!e._sortReverse,e._sortBy=r},e.myOrderCurrency={},e.$watch("fast.pair",function(r,n){if(e.myOrderCurrency._amountCurrency!==y.base.currency&&(e.myOrderCurrency._amountCurrency=y.base.currency),e.myOrderCurrency._priceCurrency!==y.trade.currency)return e.myOrderCurrency._priceCurrency=y.trade.currency}),e.$watch("currentSel.pair",function(r){var n,c,u;if(r&&(n=r.split("/"),n.length))return e.myOrderCurrency._amountCurrency=n[0],e.myOrderCurrency._priceCurrency=null!=(c=n[1].split("."))?c[0]:void 0,e.myOrderCurrency._priceIssuer=null!=(u=t.getGateway(n[1].split(".")[0],"pair"))?u.issuer:void 0})}}}])});