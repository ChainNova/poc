!function(e,n){var t=e.location;e.__=function(e){var n=2<=arguments.length?[].slice.call(arguments,1):[];return n=[].slice.call(arguments,1),e.replace(/%s/g,function(){return n.shift()})};var r=n.documentElement;t.origin||(t.origin=t.protocol+"//"+t.host),"".format||(String.prototype.format=function(){var e=arguments;return this.replace(/\{(\d+)\}/g,function(n,t){return void 0!==e[t]?e[t]:n})});var o=e.CORE||(e.CORE={});o.hosts=[];var a=n.getElementById("jseed")&&n.getElementById("jseed").getAttribute("data-main").match(/^\/j\/.+?\/[_-\w]+?\//);o.jspath=a?a[0]:"/j/",o.api={trade:"/api/",blue:"/api/blue/"},o.title=function(e){var t=" - ",r=n.title.split(t);r[1]||r.push(r[0]),e&&(r[0]=e.replace(/^./,function(e){return e.toUpperCase()})),n.title=e?r.join(t):r[1]},o._createOnceEle=function(e,t){if(e){t||(t="div");var r=n.getElementById(e);return r||(r=n.createElement(t),r.id=e,n.body.appendChild(r)),r}},o._addClass=function(e,n){n=" "+n,e.className=e.className.replace(n,"")+n},o._removeClass=function(e,n){e.className=(" "+e.className+" ").replace(" "+n+" "," ").trim()},o._killEle=function(e){"string"==typeof e&&(e=n.getElementById(e)),o._addClass(e,opt.toggle||"noDis")},o._createEle=function(e,t){t=t||{},t.tag=t.tag||"div";var r=n.getElementById(e);return r?o._removeClass(r,"noDis"):(r=n.createElement(t.tag),n.body.appendChild(r)),e&&(r.id=e),r.className=t.c||"",t.closable?(clearTimeout(r.timer),r.timer=setTimeout(function(){o._addClass(r,"noDis")},1e4),r.onclick=function(){clearTimeout(r.timer),o._addClass(r,"noDis")}):o._removeClass(r,"noDis"),r},o.msg=function(e,n){n||(n="");var t="err"!=n,r=t?"sys-msg2":"sys-msg",a=o._createEle(r,{c:"sys-msg",closable:t,toggle:"off"});return o._addClass(a,n),a.innerHTML=['<p class="cnt">','<a href="javascript:void(0)" class="close" data-dismiss="cnt"></a>',e].join(""),a},o.ts=function(e){return(e?new Date(e):new Date).getTime()},o.tsid=function(e){return(e||"")+o.ts()+Math.round(1e4*Math.random())},o.offset=function(e){var t,r,o={top:0,left:0,width:0,height:0},a=e&&(e.ownerDocument||n);if(a)return t=a.documentElement,"undefined"!=typeof e.getBoundingClientRect&&(o=e.getBoundingClientRect()),r=a.defaultView,{width:o.width||e.offsetWidth,height:o.height||e.offsetHeight,top:o.top+r.pageYOffset-t.clientTop,left:o.left+r.pageXOffset-t.clientLeft}},o.tooltip=function(e,t,r){if(e&&t){r||(r={}),r.placement||(r.placement="top"),void 0==r.autoClose&&(r.autoClose=!0);var a=n.createElement("div");a.className="tooltip "+r.placement+" "+(r.class||"")+" fade in",a.innerHTML='<div class="tooltip-arrow"></div><div class="tooltip-inner">'+t+"</div>",n.body.appendChild(a);var i=o.offset(e),s=document.getElementsByClassName("tooltip")[0];s.style.top=i.top+"px",s.style.left=i.left+"px";var l=s.offsetWidth,c=s.offsetHeight;switch(r.placement){case"right":i.left+=i.width,i.top+=i.height/2-c/2;break;case"bottom":i.left+=i.width/2-l/2,i.top+=i.height;break;case"left":i.left-=l,i.top+=i.height/2-c/2;break;default:i.left+=i.width/2-l/2,i.top-=c}s.style.top=i.top+"px",s.style.left=i.left+"px";var u=function(){n.body.removeChild(a),a=null};return r.autoClose&&setTimeout(u,r.time||500),a}},o.setCookie=function(e,t,r,o,a,i){var s=new Date;s.setTime(s.getTime());var l;!r||r instanceof Date?l=r||s:(r=1e3*r*60*60*24,l=new Date(s.getTime()+r));var c=e+"="+escape(t)+(r?";expires="+l.toGMTString():"")+(o?";path="+o:"")+(a?";domain="+a:"")+(i?";secure":"");n.cookie=c},o.getCookie=function(e){var t=new RegExp("(^| )"+e+"=([^;]*)(;|$)").exec(n.cookie);return t&&t[2]},o.queryFromArray=function(e){return function(n,t){return t instanceof RegExp?e.filter(function(e){return"string"==typeof e?e.match(t):!!e.name&&e.name.match(t)}):e}},o.j2q=function(e){var n=[];for(u in e){var t=e[u];"object"==typeof t&&(t=JSON.stringify(t)),"function"==typeof t&&(t=t.toString()),"undefined"!=typeof t&&n.push(encodeURIComponent(u)+"="+encodeURIComponent(t))}return n.join("&")},o.j2r=function(e){var n=[];return e.map(function(e){"object"==typeof e&&(e=JSON.stringify(e)),"function"==typeof e&&(e=e.toString()),n.push(encodeURIComponent(e))}),n.join("/")},o.pushArray=function(e){if(angular.isArray(e)){var n=e.slice.call(arguments,1);angular.forEach(n,function(n){e.push.apply(e,n)})}},o.getUTCHours=function(e){return(e||new Date).getUTCHours()},o.isApp=function(){return~r.className.indexOf("ua-app")},o.getNgPath=function(){var e=t.pathname.replace(/^\//,"");return e=e||t.hash.replace(/^#!?\//,""),e||"home"},o.getLoginCallbackUrl=function(){return"/passport/?passport=login&c="+encodeURIComponent(t.href)},o.pathNeedLogin=function(){var e=o.getNgPath();return/^(passport|msgs)/.test(e)?0:/^foo/.test(e)?-1:1};var i=n.createElement("a");i.id="fake",n.body.appendChild(i),o.redirect2=function(e,n){i.href=e,1==n&&(i.target="_top"),2==n&&(i.target="_blank"),i.click()},o.redirect2Login=function(e){o.redirect2(o.getLoginCallbackUrl(),e)},o.afterLogout=function(n){for(key in e.Const.user)"balance"!=key&&delete e.Const.user[key];n&&n(),e.angular&&setTimeout(function(){angular.element(r).scope().$emit("after-logout")})};var s=function(e){return{get:function(n){var t=e?e.getItem(n):null;if(!t||"null"===t)return null;try{t=JSON.parse(t)}catch(e){}return t},set:function(n,t){var r=t;if("undefined"==typeof r&&(r=t=null),"string"!=typeof t)try{r=JSON.stringify(t).replace(/,"\$\$hashKey":.*?(,|})/,"$1")}catch(e){}return e.setItem(n,r),t},getSet:function(e,n){var t=this,r=t.get(e);return setTimeout(function(){if(!r){t.set(e,n);try{r=JSON.parse(n)}catch(e){}}}),n},del:function(n){e.removeItem(n)}}};o.SS=s(sessionStorage),o.LS=s(localStorage),o.SLS={get:function(e){return o.SS.get(e)||o.LS.get(e)},set:function(e,n){return o.SS.set(e,n),o.LS.set(e,n),n}};var l={REMOTE_ERROR:"正在连接服务器..."};o.ERR=function(e){return l[e]};var c=o.ERRORCODES={FORBIDDEN:"FORBIDDEN"};for(var u in l)l.hasOwnProperty(u)&&(c[u]=u);o.STATUSES={SUCCESS:"success",FAILED:"failed"}}(window,document),define("common/core",function(){});var slice=[].slice,extend=function(e,n){function t(){this.constructor=e}for(var r in n)hasProp.call(n,r)&&(e[r]=n[r]);return t.prototype=n.prototype,e.prototype=new t,e.__super__=n.prototype,e},hasProp={}.hasOwnProperty;define("lib/BN",["BigNumber"],function(e){var n,t,r,o;return t=function(e){return 0===Number(e)?"0":e.replace(/^([\d,]+\.\d*?)0+$/,"$1").replace(/\.$/,"")},r=function(e){switch(e){case"NaN":case"Infinity":return"";default:return e}},o=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],"string"==typeof e[0]&&(e[0]=e[0].replace(/,/g,"")),e},n=function(e){function n(){var e;e=1<=arguments.length?slice.call(arguments,0):[],n.__super__.constructor.call(this,o.apply(null,e))}return extend(n,e),n.prototype.add=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],new n(n.__super__.add.call(this,o.apply(null,e)))},n.prototype.sub=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],new n(n.__super__.sub.call(this,o.apply(null,e)))},n.prototype.mul=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],new n(n.__super__.mul.call(this,o.apply(null,e)))},n.prototype.div=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],new n(n.__super__.div.call(this,o.apply(null,e)))},n.prototype.abs=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],new n(n.__super__.abs.call(this,o.apply(null,e)))},n.prototype.times=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],new n(n.__super__.times.call(this,o.apply(null,e)))},n.prototype.pow=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],new n(n.__super__.pow.call(this,o.apply(null,e)))},n.prototype.cmp=function(){var e;return e=1<=arguments.length?slice.call(arguments,0):[],n.__super__.cmp.call(this,o.apply(null,e))},n.prototype.toString=function(e,t){return r(isNaN(e)?n.__super__.toString.call(this,10):this.round(e,t).toString(10))},n.prototype.toNumber=function(e,t){return r(isNaN(e)?n.__super__.toNumber.call(this):Number(this.toString(e,t)))},n.prototype.toFormat=function(){var e,o,a;return e=1<=arguments.length?slice.call(arguments,0):[],o=~e.indexOf("fixed"),o&&e.pop(),a=n.__super__.toFormat.apply(this,e),o||(a=t(a)),r(a)},n.prototype.toPrice=function(){var e,n,t,r;switch(e=1<=arguments.length?slice.call(arguments,0):[],n=this.round().toString(10),n.length){case 1:t=5;break;case 2:t=4;break;case 3:t=3;break;default:t=2}return"0"===n&&(t=6),e.unshift(t),r=this.toFormat.apply(this,e)},n}(e),n.config({ROUNDING_MODE:n.ROUND_DOWN,ERRORS:!1}),window.BN=n}),require.config({baseUrl:"/j/",waitSeconds:15,paths:{config:"common/baseConfig",_:"/j/pub/lodash/3.5.0.min",jquery:"/j/pub/jquery/1.10.2",BigNumber:"/j/pub/bignumber/2.4.0",moment:"/j/pub/moment/2.10.3.locales",mtz:"/j/pub/moment/tz.0.5.10",angular:"/j/pub/angular/1.5.8"},shim:{angular:{exports:"angular",deps:["jquery"]}}}),define("config",["angular","common/core","lib/BN"],function(e){return{load:function(e,n,t,r){n([e],function(e){t(e)})}}}),define("vendor/ngSanitize",["angular"],function(e){"use strict";function n(){function n(e,n){var t,r={},o=e.split(",");for(t=0;t<o.length;t++)r[n?s(o[t]):o[t]]=!0;return r}function t(e,n){null===e||void 0===e?e="":"string"!=typeof e&&(e=""+e),v.innerHTML=e;var t=5;do{if(0===t)throw d("uinput","Failed to sanitize html because the input is unstable");t--,window.document.documentMode&&m(v),e=v.innerHTML,v.innerHTML=e}while(e!==v.innerHTML);for(var r=v.firstChild;r;){switch(r.nodeType){case 1:n.start(r.nodeName.toLowerCase(),p(r.attributes));break;case 3:n.chars(r.textContent)}var o;if(!(o=r.firstChild)&&(1==r.nodeType&&n.end(r.nodeName.toLowerCase()),o=r.nextSibling,!o))for(;null==o&&(r=r.parentNode,r!==v);)o=r.nextSibling,1==r.nodeType&&n.end(r.nodeName.toLowerCase());r=o}for(;r=v.firstChild;)v.removeChild(r)}function p(e){for(var n={},t=0,r=e.length;t<r;t++){var o=e[t];n[o.name]=o.value}return n}function f(e){return e.replace(/&/g,"&amp;").replace(y,function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return"&#"+(1024*(n-55296)+(t-56320)+65536)+";"}).replace(C,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function g(e,n){var t=!1,o=r(e,e.push);return{start:function(e,r){e=s(e),!t&&S[e]&&(t=e),t||O[e]!==!0||(o("<"),o(e),a(r,function(t,r){var a=s(r),i="img"===e&&"src"===a||"background"===a;D[a]!==!0||R[a]===!0&&!n(t,i)||(o(" "),o(r),o('="'),o(f(t)),o('"'))}),o(">"))},end:function(e){e=s(e),t||O[e]!==!0||b[e]===!0||(o("</"),o(e),o(">")),e==t&&(t=!1)},chars:function(e){t||o(f(e))}}}function m(e){if(e.nodeType===window.Node.ELEMENT_NODE)for(var n=e.attributes,t=0,r=n.length;t<r;t++){var o=n[t],a=o.name.toLowerCase();"xmlns:ns1"!==a&&0!==a.lastIndexOf("ns1:",0)||(e.removeAttributeNode(o),t--,r--)}var i=e.firstChild;i&&m(i),i=e.nextSibling,i&&m(i)}var h=!1;this.$get=["$$sanitizeUri",function(e){return h&&o(O,E),function(n){var t=[];return c(n,u(t,function(n,t){return!/^unsafe:/.test(e(n,t))})),t.join("")}}],this.enableSvg=function(e){return i(e)?(h=e,this):h},r=e.bind,o=e.extend,a=e.forEach,i=e.isDefined,s=e.lowercase,l=e.noop,c=t,u=g;var v,y=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,C=/([^\#-~ |!])/g,b=n("area,br,col,hr,img,wbr"),w=n("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),$=n("rp,rt"),_=o({},$,w),k=o({},w,n("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),x=o({},$,n("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),E=n("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),S=n("script,style"),O=o({},b,k,x,_),R=n("background,cite,href,longdesc,src,xlink:href"),N=n("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),j=n("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),D=o({},R,j,N);!function(e){var n;if(!e.document||!e.document.implementation)throw d("noinert","Can't create an inert html document");n=e.document.implementation.createHTMLDocument("inert");var t=n.documentElement||n.getDocumentElement(),r=t.getElementsByTagName("body");if(1===r.length)v=r[0];else{var o=n.createElement("html");v=n.createElement("body"),o.appendChild(v),n.appendChild(o)}}(window)}function t(e){var n=[],t=u(n,l);return t.chars(e),n.join("")}var r,o,a,i,s,l,c,u,d=e.$$minErr("$sanitize");e.module("ngSanitize",[]).provider("$sanitize",n),e.module("ngSanitize").filter("linky",["$sanitize",function(n){var r=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,o=/^mailto:/i,a=e.$$minErr("linky"),i=e.isDefined,s=e.isFunction,l=e.isObject,c=e.isString;return function(e,u,d){function p(e){e&&C.push(t(e))}function f(e,n){var t,r=v(e);C.push("<a ");for(t in r)C.push(t+'="'+r[t]+'" ');!i(u)||"target"in r||C.push('target="',u,'" '),C.push('href="',e.replace(/"/g,"&quot;"),'">'),p(n),C.push("</a>")}if(null==e||""===e)return e;if(!c(e))throw a("notstring","Expected string but received: {0}",e);for(var g,m,h,v=s(d)?d:l(d)?function(){return d}:function(){return{}},y=e,C=[];g=y.match(r);)m=g[0],g[2]||g[4]||(m=(g[3]?"http://":"mailto:")+m),h=g.index,p(y.substr(0,h)),f(m,g[0].replace(o,"")),y=y.substring(h+g[0].length);return p(y),n(C.join(""))}}])}),define("vendor/ngMessages",["angular"],function(e){"use strict";function n(){function e(e,n){if(e)return r(e)?e.indexOf(n)>=0:e.hasOwnProperty(n)}return["$animate",function(n){return{restrict:"AE",transclude:"element",priority:1,terminal:!0,require:"^^ngMessages",link:function(t,o,a,i,s){var l,c=o[0],u=a.ngMessage||a.when,d=a.ngMessageExp||a.whenExp,p=function(e){l=e?r(e)?e:e.split(/[\s,]+/):null,i.reRender()};d?(p(t.$eval(d)),t.$watchCollection(d,p)):p(u);var f,g;i.register(c,g={test:function(n){return e(l,n)},attach:function(){f||s(function(e,t){n.enter(e,null,o),f=e;var r=f.$$attachId=i.getAttachId();f.on("$destroy",function(){f&&f.$$attachId===r&&(i.deregister(c),g.detach()),t.$destroy()})})},detach:function(){if(f){var e=f;f=null,n.leave(e)}}})}}}]}var t,r,o,a;e.module("ngMessages",[],function(){t=e.forEach,r=e.isArray,o=e.isString,a=e.element}).directive("ngMessages",["$animate",function(e){function n(e,n){return o(n)&&0===n.length||r(e.$eval(n))}function r(e){return o(e)?e.length:!!e}var a="ng-active",i="ng-inactive";return{require:"ngMessages",restrict:"AE",controller:["$element","$scope","$attrs",function(o,s,l){function c(e,n){for(var t=n,r=[];t&&t!==e;){var o=t.$$ngMessageNode;if(o&&o.length)return v[o];t.childNodes.length&&r.indexOf(t)===-1?(r.push(t),t=t.childNodes[t.childNodes.length-1]):t.previousSibling?t=t.previousSibling:(t=t.parentNode,r.push(t))}}function u(e,n,t){var r=v[t];if(p.head){var o=c(e,n);o?(r.next=o.next,o.next=r):(r.next=p.head,p.head=r)}else p.head=r}function d(e,n,t){var r=v[t],o=c(e,n);o?o.next=r.next:p.head=r.next}var p=this,f=0,g=0;this.getAttachId=function(){return g++};var m,h,v=this.messages={};this.render=function(c){c=c||{},m=!1,h=c;for(var u=n(s,l.ngMessagesMultiple)||n(s,l.multiple),d=[],f={},g=p.head,v=!1,y=0;null!=g;){y++;var C=g.message,b=!1;v||t(c,function(e,n){if(!b&&r(e)&&C.test(n)){if(f[n])return;f[n]=!0,b=!0,C.attach()}}),b?v=!u:d.push(C),g=g.next}t(d,function(e){e.detach()}),d.length!==y?e.setClass(o,a,i):e.setClass(o,i,a)},s.$watchCollection(l.ngMessages||l.for,p.render),o.on("$destroy",function(){t(v,function(e){e.message.detach()})}),this.reRender=function(){m||(m=!0,s.$evalAsync(function(){m&&h&&p.render(h)}))},this.register=function(e,n){var t=f.toString();v[t]={message:n},u(o[0],e,t),e.$$ngMessageNode=t,f++,p.reRender()},this.deregister=function(e){var n=e.$$ngMessageNode;delete e.$$ngMessageNode,d(o[0],e,n),delete v[n],p.reRender()}}]}}]).directive("ngMessagesInclude",["$templateRequest","$document","$compile",function(e,n,t){function r(e,r){var o=t.$$createComment?t.$$createComment("ngMessagesInclude",r):n[0].createComment(" ngMessagesInclude: "+r+" "),i=a(o);e.after(i),e.remove()}return{restrict:"AE",require:"^^ngMessages",link:function(n,a,i){var s=i.ngMessagesInclude||i.src;e(s).then(function(e){n.$$destroyed||(o(e)&&!e.trim()?r(a,s):t(e)(n,function(e){a.after(e),r(a,s)}))})}}}]).directive("ngMessage",n()).directive("ngMessageExp",n())}),define("jade",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("jade!tmpl/dialog/overlay",[],function(){return'<div ng-class="{in:animate}" ng-style="{\'z-index\':1040+index*10}" ng-click="close($event)" class="overlay"></div>'}),define("jade!tmpl/dialog/window",[],function(){return'<div ng-class="{in:animate}" ng-style="{\'z-index\':1050+index*10}" ng-click="close($event)" ng-transclude="ng-transclude" class="dialog dialogLoading"></div>'}),define("jade!tmpl/dialog/title",[],function(){return'<div ngd-dialog-window="ngd-dialog-window"><div ng-click="$oclose()" title="关闭" class="iF iF-close dialogX"></div><div class="dialogT">提示</div></div>'}),define("lib/dialog",["jade!tmpl/dialog/overlay","jade!tmpl/dialog/window","jade!tmpl/dialog/title","angular"],function(e,n,t){var r=(window,document.documentElement),o=angular.element(r),a=function(e,n){return angular.element(e[0].querySelector(n))};return angular.module("dialog",[]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(n,t){e.push({key:n,value:t})},get:function(n){for(var t=0;t<e.length;t++)if(n==e[t].key)return e[t]},keys:function(){for(var n=[],t=0;t<e.length;t++)n.push(e[t].key);return n},top:function(){return e[e.length-1]},remove:function(n){for(var t=-1,r=0;r<e.length;r++)if(n==e[r].key){t=r;break}return e.splice(t,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("ngdDialogOverlay",["$dialogStack","$timeout",function(n,t){return{restrict:"EA",replace:!0,template:e,link:function(e,r,a){t(function(){e.animate=!0,o.addClass("noScroll")}),e.close=function(e){var t=n.getTop();t&&t.value.overlay&&"static"!=t.value.overlay&&(e.preventDefault(),e.stopPropagation(),t.key&&t.key.dismiss("overlay click"))}}}}]).directive("ngdDialogWindow",["$timeout",function(e){return{restrict:"EA",scope:{index:"@"},replace:!0,transclude:!0,template:n,link:function(n,t,r){n.$on("dataLoaded",function(){if(t.removeClass("pending"),r.insert){var e=a(t,"."+r.insert);e.length&&e.removeClass("pending2")}}),r.insert&&t.removeClass("pending"),e(function(){n.animate=!0})}}}]).factory("$dialogStack",["$document","$compile","$rootScope","$q","$injector","$controller","$templateCache","$http","$timeout","$$stackedMap",function(e,n,r,i,s,l,c,u,d,p){function f(){for(var e=-1,n=$.keys(),t=0;t<n.length;t++)$.get(n[t]).value.overlay&&(e=t);return e}function g(e){var n=$.get(e).value;$.remove(e),n.modalDomEl.remove(),o.removeClass("noScroll"),C&&f()==-1&&(C.remove(),C=void 0),n.modalScope.$destroy()}function m(e){return e.template?i.when(e.template):u.get(e.templateUrl,{cache:c}).then(function(e){return e.data})}function h(e){var n=[];return angular.forEach(e,function(e,t){(angular.isFunction(e)||angular.isArray(e))&&n.push(i.when(s.invoke(e)))}),n}function v(e){e.on("mousedown",k.mousedown)}var y,C,b=r.$new(!0),w=e.find("body").eq(0),$=p.createNew(),_={};r.$watch(f,function(e){b.index=e}),e.on("keydown",function(e){var n,t=angular.isDefined(e.which)?e.which:e.keyCode;if(n=$.top(),27===t&&n&&n.value.keyboard&&r.$apply(function(){n.key&&n.key.dismiss("overlay click")}),n&&8===t){var o=e.target.tagName.toLowerCase();"input"!=o&&"textarea"!=o&&(e.preventDefault(),e.stopPropagation())}});var k={downed:!1,x:null,y:null,target:null,dialog:null,tH:0,bH:0,mousedown:function(n){k.downed=!0,n.preventDefault();var t=k.target=angular.element(n.currentTarget||this),r=k.dialog=t.parent(),o=a(r,".dialogB"),i=a(r,".dialogF");k.tH=t[0].offsetHeight,k.bH=o.length>0?o[0].offsetHeight:i.length>0?i[0].offsetHeight:0,k.x=n.pageX-r[0].offsetLeft,k.y=n.pageY-r[0].offsetTop,t.css({cursor:"move"}),e.on("mousemove",k.mousemove),e.on("mouseup",k.mouseup)},mousemove:function(n){if(k.downed){n.preventDefault();var t=3,r=n.clientX-k.x,o=n.clientY-k.y,a=k.dialog[0].offsetWidth+t,i=k.dialog[0].offsetHeight+t,s=e[0].documentElement.clientWidth,l=e[0].documentElement.clientHeight;r-t<=0&&(r=t),r+a>=s&&(r=s-a),o-t<=t&&(o=t),o+i+k.bH>=l&&(o=l-i-k.bH),k.dialog.css({left:r+"px",top:o+"px",margin:"0 0 0 0"})}},mouseup:function(n){k.downed=!1,k.x=null,k.y=null,k.tH=0,k.bH=0,k.target.css({cursor:""}),n.preventDefault(),e.off("mousemove",k.mousemove),e.off("mouseup",k.mouseup)}};return _.open=function(e,r){var o=r.modalOptions,s=i.all([m(o)].concat(h(o.resolve)));s.then(function(t){var i,s={},c=1;d(function(){r.scope.$broadcast("dataLoaded")},10),o.controller&&(s.$scope=r.scope,s.$dialogInstance=e,s.$element=u,angular.forEach(o.resolve,function(e,n){s[n]=t[c++]}),i=l(o.controller,s));var p=angular.element("<div></div>");p.html(t[0]);var f=n(p)(r.scope);if(u){if(o._insertClass){var g=a(u,"."+o._insertClass);g.length?angular.element(g[0]).append(f.contents()):u.append(f.contents())}else u.append(f.contents());if(o.dragable){var m=a(u,".dialogT");m.length&&v(m)}}},function(n){r.deferred.reject(n),d(function(){e.close()},0);var t=n.data&&n.data.error_text||"载入失败，请稍后再试.";CORE.alert?alert(t):alert(t)}),s.then(function(){r.loadedDeferred.resolve(!0)},function(){r.loadedDeferred.reject(!1)}),$.add(e,{deferred:r.deferred,modalScope:r.scope,overlay:o.overlay,dragable:o.dragable,keyboard:o.keyboard}),f()>=0&&!C&&(y=angular.element("<div ngd-dialog-overlay></div>"),C=n(y)(b),w.append(C)),e.updateTitle=function(e){if(u){var n=a(u,".dialogT");n.length&&n.html(e)}};var c=angular.element(t).addClass(o.classname).attr("index",$.length()-1).attr("insert",o._insertClass||"");o.hideClose&&c.addClass("noClose"),o.title&&a(c,".dialogT").html(o.title);var u=n(c)(r.scope);$.top().value.modalDomEl=u,w.append(u)},_.close=function(e,n){var t=$.get(e);t&&(t.value.deferred.resolve(n),g(e))},_.dismiss=function(e,n){var t=$.get(e).value;t&&(t.deferred.reject(n),g(e))},_.show=function(e){var n=$.get(e);if(!n)return!1;var t=n.value;return t&&t.modalDomEl&&t.modalDomEl.css({opacity:"1"}),!0},_.hide=function(e){var n=$.get(e).value;n&&n.modalDomEl&&n.modalDomEl.css({opacity:"0"})},_.addClass=function(e,n){var t=$.get(e).value;t&&t.modalDomEl&&t.modalDomEl.addClass(n)},_.removeClass=function(e,n){var t=$.get(e).value;t&&t.modalDomEl&&t.modalDomEl.removeClass(n)},_.getTop=function(){return $.top()},_}]).provider("$dialog",function(){var e={options:{overlay:"static",keyboard:!0,dragable:!0,onClose:angular.noop,onConfirm:angular.noop,onDismiss:angular.noop,hideClose:!1},$get:["$rootScope","$q","$dialogStack",function(n,t,r){var o={};return o.open=function(o){var a=t.defer(),i=t.defer(),s={result:a.promise,loaded:i.promise,close:function(e){return r.close(s,e)},dismiss:function(e){!1!==o.onDismiss.call(l,l,s)&&r.dismiss(s,e)},hide:function(){return r.hide(s)},show:function(){return r.show(s)},addClass:function(e){r.addClass(s,e)},removeClass:function(e){r.removeClass(s,e)}};if(o=angular.extend({},e.options,o),o.resolve=o.resolve||{},!o.template&&!o.templateUrl)throw new Error("One of template or templateUrl options is required.");var l=(o.scope||n).$new();return l.$close=s.close,l.$dismiss=s.dismiss,l.$hide=s.hide,l.$show=s.show,l.$addClass=s.addClass,l.$removeClass=s.removeClass,l.$oclose=function(){!1!==o.onClose.call(l,l,s)&&l.$close()},l.$ok=function(){!1!==o.onConfirm.call(l,l,s)&&l.$close()},r.open(s,{scope:l,deferred:a,loadedDeferred:i,modalOptions:o}),s},o}]};return e})});var indexOf=[].indexOf||function(e){for(var n=0,t=this.length;n<t;n++)if(n in this&&this[n]===e)return n;return-1};define("common/locales",["angular"],function(e){var n,t,r,o,a,i,s,l;return a="lang",t=document.documentElement,r=location.hostname.match(/\w+\.\w+$/)[0],CORE.setCookie(a,"",-1,"/"),n="",i=["zh_CN","en_US"],s=[{value:"zh_CN",name:"中文(简体)",iso2Code:"ZH"},{value:"en_US",name:"English",iso2Code:"US"}],l=function(e){if(e!==n)return indexOf.call(i,e)<0&&(e=i[0]),CORE.setCookie(a,e,1e3,"/",r),n=e},o=function(e,n){var t,r,o;if(!n)return e;for(t=0,o=s.length;t<o;t++)if(r=s[t],r.value===e)return r},{localesObj:s,getAll:function(e){return e?s:i},get:function(e){var t,r,s;return n?o(n,e):(r=CORE.getCookie(a),r||(s=navigator,t=s.language||s.useLanguage||s.browserLanguage,r=/^zh/.test(t)?"zh_CN":i[0]),l(r),o(r,e))},set:l}}),define("jade!tmpl/intercept/unlock",[],function(){return'<div class="dialogC"><form name="former" ng-submit="confirm()" class="form2"><input type="password" autocomplete="off" class="noDis"/><div class="frmCol frmColFull"><p class="frm txt"><input type="password" required="required" novalidate="novalidate" name="pay_pwd" ng-model="unlock.pay_pwd" placeholder="支付密码" class="txt large"/><label title="支付密码"></label></p></div><div ng-if="hasPhonePwd" class="frmCol frmColFull frmCol55"><p class="frm txt"><input type="text" required="required" novalidate="novalidate" name="vcode" ng-model="unlock.password_pay" placeholder="输入短信验证码" class="txt"/><label title="输入短信验证码"></label></p><p class="frm btns2r"><button type="button" ng-click="getVcode()" ng-disabled="!former.vcode || cd&gt;0 || vcodePending" data-ca="unlock-sendvcode" ng-class="{pending: vcodePending}" class="btn btn-vcode btn_minor">发送验证码<q ng-if="cd&gt;0" ng-bind="cd" class="cd"></q></button></p></div><div ng-if="hasGAuth" class="frmCol frmColFull"><p class="frm txt"><input type="text" required="required" novalidate="novalidate" ng-model="unlock.password_pay" placeholder="输入Google验证器动态码" class="txt"/><label title="输入Google验证器动态码"></label></p></div><div ngd-hint="apiErr" ngd-hint-lv="err"></div><div class="frmCol frmColFull"><p class="frm"><button type="submit" ng-disabled="former.$invalid || former.$pending || pending" data-ca="unlock-submit" ng-class="{pending: pending}" class="btn btn1">确认</button></p></div></form></div>'}),define("jade!tmpl/intercept/smsauth",[],function(){return'<div class="dialogC"><p style="margin-bottom:15px" class="alert alert-danger">你的账号状态异常，应该完成{{flagName}}</p><form name="former" ng-submit="confirm()" ng-switch="flag" class="form2"><input type="password" autocomplete="off" class="noDis"/><div ng-switch-when="0" class="frmCol frmColFull"><p class="frm txt"><input type="password" required="required" novalidate="novalidate" name="pay_pwd" ng-model="frm.code" placeholder="支付密码" class="txt large"/><label title="支付密码"></label></p></div><div ng-switch-when="2" class="frmCol frmColFull frmCol55"><p class="frm txt"><input type="text" required="required" novalidate="novalidate" name="vcode" ng-model="frm.code" placeholder="输入短信验证码" class="txt"/><label title="输入短信验证码"></label></p><p class="frm btns2r"><button type="button" ng-click="getVcode()" ng-disabled="!former.vcode || cd&gt;0 || vcodePending" data-ca="unlock-sendvcode" ng-class="{pending: vcodePending}" class="btn btn-vcode btn_minor">发送验证码<q ng-if="cd&gt;0" ng-bind="cd" class="cd"></q></button></p></div><div ng-switch-when="1" class="frmCol frmColFull"><p class="frm txt"><input type="text" required="required" novalidate="novalidate" ng-model="frm.code" placeholder="输入Google验证器动态码" class="txt"/><label title="输入Google验证器动态码"></label></p></div><div ngd-hint="apiErr" ngd-hint-lv="err"></div><div class="frmCol frmColFull"><p class="frm"><button type="submit" ng-disabled="former.$invalid || former.$pending || pending" data-ca="ip-reauth-submit" ng-class="{pending: pending}" class="btn btn1">解锁</button></p></div><p class="fucs2">或&nbsp;<a href="/logout" target="_self" class="fuc">使用其它账号登录</a></p></form></div>'}),define("jade!tmpl/intercept/admin_unlock",[],function(){return'<div class="dialogC"><form name="loginUnlockForm" ng-submit="doUnlock()" class="form2"><div class="frmCol frmColFull"><p class="frm txt"><input type="password" required="required" novalidate="novalidate" name="pwd_pwd" ng-model="unlock.pay_pwd" placeholder="支付密码" class="txt large"/><label title="支付密码"></label></p></div><div ngd-hint="apiErr" ngd-hint-lv="err"></div><div class="frmCol frmColFull"><p class="frm"><button type="submit" ng-disabled="loginUnlockForm.$invalid || loginUnlockForm.$pending || pending" data-ca="login-unlock-submit" ng-class="{pending: pending}" class="btn btn1">解锁</button></p></div></form></div>'}),define("lib/ajax-intercept",["angular","common/locales","jade!tmpl/intercept/unlock","jade!tmpl/intercept/smsauth","jade!tmpl/intercept/admin_unlock"],function(e,n,t,r,o){CORE.api.admin,n.get();e.module("ajaxIntercept",["dialog"]).factory("interceptServ",["$rootScope","$timeout","$interval","$dialog",function(e,n,a,i){var s={unlock:null,reauth:null,frozen:0},l=null,c=function(e,n){s.frozen++,l=CORE.msg(CORE.ERR(CORE.ERRORCODES.REMOTE_ERROR),"err"),setTimeout(function(){s.frozen--,n("retry").success(u).error(u)},5e3)},u=function(){s.frozen>0||!l||(CORE._killEle(l),s.frozen=0)},d=[],p=function(e,n){for(;d.length;)d.shift()(e,n)},f=function(e,n){d.push(n),s.adminunlock&&s.adminunlock.show()||(s.adminunlock=i.open({title:"Admin Unlock",dragable:!1,keyboard:!1,hideClose:!0,classname:"dialog3",template:o,onClose:function(){p(null,"canceled")},controller:["$scope","$timeout","ppServ",function(e,n,t){e.unlock={},e.doUnlock=function(){e.pending=!0,t.unlock(e.unlock.pay_pwd,function(n,t){return e.pending=!1,t?void(e.apiErr=t):(s.adminunlock.close(),p(n))})}}]}))},g=[],m=function(e,n){for(;g.length;)g.shift()(e,n)},h=function(e,n){g.push(n),s.reauth&&s.reauth.show()||(s.reauth=i.open({title:"提示",dragable:!1,keyboard:!1,hideClose:!0,classname:"dialog3",template:r,onClose:function(){m(null,"canceled")},controller:["$scope","$timeout","$interval","accountServ",function(n,t,r,o){n.frm={},n.flag=Number(e.error.dynamic_flag),n.flagName=0==n.flag?"支付密码":"动态验证",n.confirm=function(){n.pending=!0,o.verifySMSCode(n.frm.code,function(e,t){return n.pending=!1,t?n.apiErr=t:(s.reauth.close(),m(e))})},cd=function(e){e?n.cd=e:n.cd--,n.cd&&t(cd,1e3)},n.getVcode=function(){n.vcodePending=!0,delete n.apiErr,o.sendSms("","",function(e,t){if(n.vcodePending=!1,cd(60),t)return n.apiErr=t})}}]}))},v=[],y=function(e,n){for(;v.length;)v.shift()(e,n)},C=function(e,n){var r="ACCOUNT_DYNAMIC_LOCK"==e.error_code?1:0;v.push(n),s.unlock&&s.unlock.show()||(s.unlock=i.open({title:"操作前须解锁.",classname:"dialog3",template:t,onClose:function(){y(null,"canceled")},controller:["$scope","$timeout","$interval","accountServ",function(e,n,t,o){var a=e.hasGAuth=Const.user.hasSetGoogleAuth,i=e.hasPhonePwd=Const.user.hasSetPhonePassword||r;
cd=function(t){t?e.cd=t:e.cd--,e.cd&&n(cd,1e3)},e.confirm=function(){_pay_pwd=e.unlock.pay_pwd,_phone_pwd="",(a||i)&&(_pay_pwd=e.unlock.pay_pwd,_phone_pwd=e.unlock.password_pay),e.pending=!0,o.userUnlock(_pay_pwd,_phone_pwd,r,function(n,t){return e.pending=!1,t?e.apiErr=t:(s.unlock.close(),void y(n))})},e.getVcode=function(){e.vcodePending=!0,delete e.apiErr,o.sendSms("","",function(n,t){if(e.vcodePending=!1,cd(60),t)return e.apiErr=t})}}]}))};return{dialog:function(e,n){switch(e.error_code){case"ACCOUNT_LOCK":case"ACCOUNT_DYNAMIC_LOCK":C(e,n);break;case"COOKIE_NOT_UNLOCK":h(e,n);break;case"ADMIN_COOKIE_NOT_UNLOCK":f(e,n);break;case"REMOTE_ERROR":c(e,n)}}}}])}),define("lib/ajax",["angular","lib/ajax-intercept"],function(e){var n=window,t=function(n){var t=n.data;if("object"==typeof t){t||(t={});var r=t.data||t.result||e.copy(t);return r._res=t,t.data=r,delete t.result,n.data=t,t}},r=function(e){var n=e.data,t=n.error_code||n.code,r=n.message||n.mag;return delete e.data,{error:n,error_code:t,error_msg:CORE.ERR(t)||CORE.ERR(r)||r||"未知错误，请稍后重试。"}};return e.module("ajax",["ajaxIntercept"]).config(["$httpProvider",function(e){e.interceptors.push(["$q",function(e){return{request:function(n){return n&&(n.headers||(n.headers={}),n.headers["X-Requested-With"]="XMLHttpRequest"),n||e.when(n)}}}]),e.interceptors.push(["$q",function(e){responseError=function(t,o,a){return o&&(o=r(o),a&&(o._OK=!0),t.data=o),t&&t.data&&"NOT_LOGIN"===t.data.error_code&&(n.Const.loginChecked=1,CORE.afterLogout()),e.reject(t)};var o={response:function(e){var n=t(e);if(n){if("error_code"in n.data||n.status&&n.status!==CORE.STATUSES.SUCCESS)return responseError(e,n,!0);n.status||200!=e.status||(n.status="success"),e.data=n.data,delete n.data}else e._OK=!0;return e},responseError:function(e){return responseError(e,t(e))}};return o}])}]).factory("ajax",["$http","$q","interceptServ",function(n,t,o){function a(n,t){var r,o=[],a=function(e,n){n=null==n?"":n,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(n)};if(void 0===t&&(t=!1),e.isArray(n))e.forEach(n,function(e,n){a(e.name,e.value)});else for(r in n)c(r,n[r],t,a);return o.join("&").replace(s,"+")}function i(i){var s=t.defer(),l=t.defer(),c=s.promise;i.headers||(i.headers={}),"content-type"in i.headers||(i.headers["content-type"]="application/x-www-form-urlencoded; charset=UTF-8");var d=i.transformRequest||[];d.unshift(function(n,t){var r=t("content-type");if(e.isObject(n)&&r){if(r.match(/^application\/x-www-form-urlencoded/))return a(n);if(r.match(/^application\/json/))return e.toJson(n)}return n}),i.transformRequest=d,i.xsrfCookieName="_xsrf",c.success=function(e){return c.then(function(n){n&&e(n.data,n.status,n.headers,i)}),c},c.error=function(e){return c.catch(function(n){n&&e(n.data,n.status,n.headers,i)}),c},c.abort=function(e){return l.resolve(e||{}),c},c.setCategory=function(e){var n=u[e];return n||(n=u[e]=[]),i.category=e,n.push(c),c};var p=function(){c.abort=e.noop;var n=u[i.category];n&&(e.each(n,function(e,t){if(e===c)return n.splice(t,1),!1}),n.length||(n=u[i.category]=null))};i.method&&"get"!=i.method.toLowerCase()||(i.url+=(~i.url.indexOf("?")?"&":"?")+"ts="+(new Date).getTime()),i.timeout||(i.timeout=l.promise),i.category&&c.setCategory(i.category),_CORE=CORE,ERRORCODES=_CORE.ERRORCODES;var f=function(e){n(i).then(function(e){p(),s.resolve(e)}).catch(function(e){var n=e.data;if("object"==typeof n){var t=n.error._res;switch(t.status===_CORE.STATUSES.FAILED&&t.nick&&(Const.user||(Const.user={}),Const.user.nick=t.nick),n.error_code){case"REMOTE_ERROR":case"COOKIE_NOT_UNLOCK":case"ADMIN_COOKIE_NOT_UNLOCK":case"ACCOUNT_LOCK":case"ACCOUNT_DYNAMIC_LOCK":return void o.dialog(n,function(n,t,r){return t?(p(),void s.reject(e)):(f(r),c)})}}else e._OK||(e.data=r({data:{status:e.status,_res:{text:e.data},error_code:ERRORCODES.SERVER_ERROR}}));p(),s.reject(e)}).then(function(){e&&e()})};return f(),c}var s=/%20/g,l=/\[\]$/,c=function(n,t,r,o){var a;if(e.isArray(t))e.forEach(t,function(e,t){r||l.test(n)?o(n,e):c(n+"["+("object"==typeof e?t:"")+"]",e,r,o)});else if(!r&&e.isObject(t))for(a in t)c(n+"["+a+"]",t[a],r,o);else o(n,t)},u={};return["get","post","put"].forEach(function(e){i[e]=function(n,t,r){return"get"==e&&(r=t),r||(r={}),r.url=n,r.method=e,"get"!=e&&(r.data=t),i(r)}}),i.abort=function(n){var t=u[n];t&&e.isArray(t)&&(e.forEach(t,function(e){e.abort(),e=null}),t=u[n]=null)},i.param=a,i}])}),define("common/module",["config","vendor/ngSanitize","vendor/ngMessages","lib/dialog","lib/ajax"],function(){var e=window.Const;return e.user||(e.user={}),e.user.balance||(e.user.balance={ts:null,all:[]}),angular.module("CORE",["ngSanitize","ngMessages","ajax","dialog"])}),define("jade!tmpl/passport",[],function(){return'<div ng-switch="PP.action" ng-class="[PP.action]" class="Passport"><div ng-switch-when="login" class="passport"><form name="former" ng-submit="login()" class="form form2"><div class="frmCol"><p class="frm txt corename frm_icon"><input type="text" name="uname" autocomplete="uname" ng-model="formData.uname" placeholder="用户名" minlength="3" maxlength="15" required class="txt"><label title="用户名"></label><span ng-messages="former.uname.$error" role="alert"><span ng-message="minlength">至少需要3个字符</span><span ng-message="maxlength">不能多于15字符</span></span></p></div><div class="frmCol"><p class="frm txt pwd frm_icon icon_pwd"><input type="password" placeholder="密码" ng-model="formData.pwd" name="pwd_login" autocomplete="pwd_login" required class="txt"><label title="密码"></label></p></div><div ngd-hint="apiErr" ngd-hint-lv="err"></div><div class="frmCol frmColFull btns"><p class="frm"><button type="submit" ng-disabled="former.$invalid || former.$pending || pending" data-ca="passport-submit-login" ng-class="{pending: pending}" class="btn btn1 btn_next">登录</button></p></div></form></div><div ng-switch-when="signup" class="passport"><form name="former_reg" ng-submit="signup()" class="form form2"><input type="password" autocomplete="off" class="noDis"><div class="frmCol"><p class="frm txt corename"><input type="text" autocomplete="off" name="uname_reg" ng-model="formData.uname" placeholder="用户名" minlength="4" maxlength="15" required ng-pattern="/^(?=.*[a-z].*)[a-z0-9-]+$/" rd-uname ng-model-options="{debounce:400, blur: 0}" class="txt"><label title="用户名"></label><span ng-messages="former_reg.uname_reg.$error" role="alert"><span ng-message="minlength">至少需要4个字符</span><span ng-message="maxlength">不能多于15字符</span><span ng-message="pattern">只有a-z, 0-9 and hyphen (-), and must include at least one (a-z)</span><span ng-message="unameExists">用户名已存在</span></span></p></div><div class="frmCol"><p class="frm txt pwd"><input type="password" placeholder="登录密码" ng-model="formData.pwd" name="pwd" required ngd-pwd="strength" class="txt"><label title="登录密码"></label><span ng-class="{active: strength}" class="txt-msgs"><span ng-show="strength==\'match\'" class="txt-msg err">登录密码不能包含用户名</span><span ng-show="strength==\'weak\'" class="txt-msg bad">登录密码强度：简单</span><span ng-show="strength==\'medium\'" class="txt-msg bette">登录密码强度：中等</span><span ng-show="strength==\'strong\'" class="txt-msg best">登录密码强度：很好</span></span></p></div><div class="frmCol"><p class="frm txt pwd pwd2"><input type="password" placeholder="支付密码" ng-model="formData.pay_pwd" name="pay_pwd" required ngd-pwd="pay_strength" class="txt"><label title="支付密码"></label><span ng-class="{active: pay_strength}" class="txt-msgs"><span ng-show="pay_strength==\'match\'" class="txt-msg err">支付密码不能包含用户名</span><span ng-show="pay_strength==\'matchPwd\'" class="txt-msg err">支付密码不能和登录密码相同</span><span ng-show="pay_strength==\'weak\'" class="txt-msg bad">支付密码强度：简单</span><span ng-show="pay_strength==\'medium\'" class="txt-msg better">支付密码强度：中等</span><span ng-show="pay_strength==\'strong\'" class="txt-msg best">支付密码强度：很好</span></span></p></div><div class="frmCol"><p class="frm txt"><input type="email" placeholder="邮箱" ng-model="formData.email" name="email" required rd-umail ng-model-options="{debounce:400}" class="txt"><label title="邮箱"></label><span ng-messages="former_reg.email.$error" role="alert"><span ng-message="email">邮箱格式不正确</span><span ng-message="umailExists">邮箱地址已存在</span></span></p></div><div ng-if="conf.needMobi" class="frmCol frmColFull frmCol46"><p class="frm sel sel1"><select ng-model="formData.phoneCode" ng-options="country.value as \'(+\'+country.value+\') \'+country.name for country in countries"></select><label title="国家区号"></label><span class="txt-msgs active"><span class="txt-msg info">国家区号</span></span></p><p class="frm txt"><input type="text" placeholder="手机号" ng-model="formData.phoneNumber" name="phoneNumber" required ng-pattern="/[0-9]{10,}/" ng-model-options="{debounce:200}" class="txt"><label title="手机号"></label><span ng-messages="former_reg.phoneNumber.$error" role="alert"><span ng-message="pattern">手机号格式不正确</span></span></p></div><div ng-if="conf.needMobi" class="frmCol frmColFull frmCol46"><p class="frm txt"><input type="text" placeholder="手机验证码" ng-model="formData.verifyCode" name="verifyCode" required ng-pattern="/[0-9]{6}/" ng-model-options="{debounce:200}" class="txt"><label title="手机验证码"></label><span ng-messages="former_reg.verifyCode.$error" role="alert"><span ng-message="pattern">手机验证码格式不正确</span></span></p><p class="frm btns2r"><button type="button" ng-click="sendVCode()" ng-disabled="!former_reg.phoneNumber.$valid || cd&gt;0 || vcodePending" data-ca="signup-sendvcode" ng-class="{pending: vcodePending}" class="btn btn-vcode btn_minor">发送验证码<q ng-if="cd&gt;0" ng-bind="cd" class="cd"></q></button></p></div>\n<div ngd-hint="apiErr" ngd-hint-lv="err"></div><div class="frmCol frmColFull btns"><p class="frm"><button type="submit" ng-disabled="former_reg.$invalid || former_reg.$pending" data-ca="passport-submit-signup" ng-class="{pending: pending}" class="btn btn1 btn_next">注册</button></p></div><p class="fucs2"><a href="javascript:void(0)" ngd-passport="login" data-ca="passport-login" class="fuc">登录</a></p></form></div></div>'}),define("components/pwd-strength",["common/module"],function(e){return e.directive("ngdPwd",function(){return{require:"ngModel",restrict:"A",link:function(e,n,t,r){var o,a,i,s,l,c;if(r)return a=t.ngdPwd||"strength",o=t.ngdPwdFormdata||"formData",delete e[a],i=function(e,n){var t,r,o,a,i,s,l;for(s="",t=o=0,a=n.length;o<a;t=++o){for(l=n[t],i=!0,r=0;r<e&&r+t+e<n.length;)i=i&&n.charAt(r+t)===n.charAt(r+t+e),r++;r<e&&(i=!1),i?(t+=e-1,i=!1):s+=n.charAt(t)}return s},s=function(t){r.$setValidity(a,!1),e[a]=t,n.parent().removeClass("txt-msgs-active")},l=function(t){r.$setValidity(a,!0),e[a]=t,n.parent().addClass("txt-msgs-active")},c=function(n){var t,r,c,u,d,p,f,g,m,h,v;return h=0,n?(v=""+(null!=(c=e[o])?c.uname:void 0)||(null!=(u=Const.user)?u.nick:void 0),v&&~n.toLowerCase().indexOf(v.toLowerCase())?s("match"):(t=""+(null!=(d=e[o])?d.pwd:void 0)||(null!=(p=e[o])?p.password:void 0),t&&t.toLowerCase()===n.toLowerCase()?s("matchPwd"):(r=""+(null!=(f=e[o])?f.oldpwd:void 0)||(null!=(g=e[o])?g.pwd:void 0)||(null!=(m=e[o])?m.password:void 0),r&&r.toLowerCase()===n.toLowerCase()?s("newIsOld"):n.length<6?s("weak"):(h+=4*n.length,h+=1*(i(1,n).length-n.length),h+=1*(i(2,n).length-n.length),h+=1*(i(3,n).length-n.length),h+=1*(i(4,n).length-n.length),n.match(/(.*[0-9].*[0-9].*[0-9])/)&&(h+=5),n.match(/(.*[!,@,#,$,%,&,*,?,_,~].*[!,@,#,$,%,&,*,?,_,~])/)&&(h+=5),n.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(h+=10),n.match(/([a-zA-Z])/)&&n.match(/([0-9])/)&&(h+=15),n.match(/([!,@,#,$,%,&,*,?,_,~])/)&&n.match(/([0-9])/)&&(h+=15),n.match(/([!,@,#,$,%,&,*,?,_,~])/)&&n.match(/([a-zA-Z])/)&&(h+=15),(n.match(/^\w+$/)||n.match(/^\d+$/))&&(h-=10),h<0&&(h=0),h>100&&(h=100),h<34?s("weak"):(l(h>=68?"strong":"medium"),n))))):e[a]=""},r.$formatters.push(c),r.$parsers.unshift(c),t.$observe("ngdPwd",function(){return c(r.$viewValue)})}}})}),define("components/markup",["common/module"],function(e){var n;return n=function(e){return e?(e=e.replace(/(`|\*\*|__)(.*?)\1/g,function(){var e,n,t,r;switch(e=arguments,n=e[0],r=e[1],t=e[2],r){case"`":n='<span class="code">'+t+"</span>";break;case"**":n='<span class="bold">'+t+"</span>";break;case"__":n='<span class="italic">'+t+"</span>"}return n}),e=e.replace(/\[(.*?)\]\((.+?)\)/g,function(){var e,n,t,r,o,a,i;return e=arguments,r=e[0],n=e[2].split(" "),i=n[0],a=(null!=(t=n[1])?t.replace(/^['"]|['"]$/g,""):void 0)||"",o=e[1]||i.replace(/^(mailto|tel|sms):/,""),'<a class="uri" href="'+i+'"'+a+">"+o+"</a>"})):""},e.directive("ngdMarkup",["$compile","$sce",function(e,t){return{scope:{markup:"=ngdMarkup"},link:function(t,r,o){var a;return a=function(o){return e(r.addClass("Markup").html(n(o)).contents())(t)},o.ngdMarkup?t.$watch("markup",function(e){return a(e)}):a(r.html())}}}])}),define("common/Gateway",["common/core"],function(){var e=(CORE.api.trade,[{name:"USD",url:"usd",currency:"usd",accounts:[{address:"chaQfQJHfCWaCgRdx327RhZoJuaK5q87kS",needShowSpecial:1,currencies:["USD"],hotwallets:[]}],available:"All countries",fees:"0%",reviews:"",term_url:"",href_url:""},{name:"BTC",url:"btc",currency:"btc",accounts:[{address:"cfqaZrjWtdcXgZZ7zCLztBLs7jsFF5yKR6",needShowSpecial:1,currencies:["BTC"],hotwallets:[]}],available:"All countries",fees:"0%",reviews:"",term_url:"",href_url:""}]);return e});var indexOf=[].indexOf||function(e){for(var n=0,t=this.length;n<t;n++)if(n in this&&this[n]===e)return n;return-1};define("lib/coin",["common/Gateway"],function(e){var n,t,r,o,a,i,s,l;return n=.001,t=1e6,i=[],a=function(e){return!!~i.indexOf(e.toUpperCase())},r=function(e){return!e||a(e)?6:8},o=[void 0,null,""],l=[void 0,!1,"no"],s=function(e,n,a){var i,s,c,u,d,p,f,g,m,h,v,y,C,b,w,$;return d=e,~o.indexOf(d)?f=d=n.default||"":(n||(n={}),f=d,n.round&&(b=BN[n.round]),v=r(n.currency),$=!~[void 0,"precission"].indexOf(n.precision),$&&(v=n.precision),w=n.ngdAmountShort||n.short,w?(u=BN.ROUND_HALF_EVEN,c=$?v:0,s=new BN(d),i=s.toString(0,u),g=i.length,f=g<4?c?s.toString(c,u):i:g<7?s.div(1e3).toString(c||1,u)+("upper"===w?"K":"k"):s.div(t).toString(1,u)+("upper"===w?"M":"m")):(p=n.fixed,y=n.fixed,p=indexOf.call(l,y)>=0?null:"fixed",m=new BN(d),C=n.isPrice,h=indexOf.call(l,C)<0?m.toPrice(b,p):m.toFormat(v,b,p),h=h.split("."),0===v&&(h.length=1),h[1]&&(h[1]='<span class="dec">.'+h[1].replace(/(0+)$/,"<span>$1</span>")+"</span>"),f=h.join(""))),a?(a.html(f),void 0===a.attr("title")||a.attr("title-hold")?(a.attr("title",e),a.attr("title-hold",!0)):void 0):f},{Fee:n,Rate:t,isNative:a,getPrecision:r,prettyAmount:s}}),define("lib/unifyBalance",["lib/coin"],function(e){var n;return n=function(n,t){var r,o,a,i,s,l;for(r=t.userInfo,r&&(delete Const.user.inactive,angular.extend(Const.user,r)),a=[],l=t.assets,i=0,s=l.length;i<s;i++)o=l[i],a.push({name:o.currency,currency:o.currency.toUpperCase(),total:new BN(o.count).add(o.lockCount).toString(),balance:o.count,precision:e.getPrecision(o.currency||2)});return n.all.length=0,[].push.apply(n.all,a),n},{all:n}}),define("services/balance",["common/module","lib/unifyBalance"],function(e,n){var t;return t=CORE.api.trade,e.factory("balanceServ",["ajax","$rootScope","$timeout",function(e,r,o){var a,i,s,l,c,u,d,p,f,g,m;return a=Const.user.balance,d=function(){if(!a)return a=Const.user.balance={ts:null,all:[]}},d(),l=function(e){return d(),a.all.length=0,a.ts=e?null:CORE.ts()},r.$on("after-logout",function(){return l(!0)}),f=null,m=function(){if(f.req)return f.watcher(),f.req.req.command="unsubscribe"},g=null,c=function(e){return o.cancel(g),g=o(u,e||500)},p=function(){if(!f)return f={},r.$watch("Const.user.enrollId",function(e,n){return e?e&&n&&e!==n?(m(),l(!0),void o(function(){return f=null,p()})):u():(n&&m(),void l(!0))})},s=!1,i=null,u=function(){return i&&i.abort(),s=!0,i=e.get(t+"myasset").success(function(e){return s=!1,n.all(a,e),a.ts=CORE.ts(),r.$broadcast("balance-update"),c(5e3)}).error(function(e){return c(5e3)})},{empty:l,all:function(){return p(),a},getBalance:u}}])}),define("services/pp",["common/module","common/locales","services/balance"],function(e,n){var t,r,o;return t=CORE.api.trade,r=n.get(),o=location.origin+"/passport/?passport=login",e.factory("ppServ",["ajax","$location","balanceServ",function(e,n,a){var i,s;return i=function(){return n.search().c},s={headers:{"content-type":"application/json"}},{login:function(n,r){var o;return o={enrollId:n.uname,enrollSecret:n.pwd},e.post(t+"login",o,s).success(function(e){return Const.justlogin=!0,angular.merge(Const.user,e.userInfo),a.empty(),r(e)}).error(function(e){return r(null,e)})},signup:function(n,a){var i;return i={json:{username:n.uname,password:n.pwd,pay_pwd:n.pay_pwd,email:n.email},lan:r,withCredentials:!0,seed:n.seed,callback:o},(n.verifyCode||n.phoneNumber)&&(i.json.verifyCode=n.verifyCode,i.json.phoneNumber=n.phoneNumber,i.json.phoneCode=n.phoneCode),e.post(t+"user/register",CORE.j2q(i)).success(function(e){return Const.justlogin=!0,Const.user=e.userInfo,a(e)}).error(function(e){return a(null,e)})},activateEmail:function(n,a){var i;return i=CORE.j2q({email:n,lan:r,callback:o}),e.get(t+"user/send_activated_mail?"+i).success(function(e){return a(e)}).error(function(e){return a(null,e)})},recoveryGetVerifyCode:function(n,r){var o;return o=CORE.j2q({nick:n.uname}),e.post(t+"user/send_sms_verify_code?"+o).success(function(e){return r(e)}).error(function(e){return r(null,e)})},recoveryByEmail:function(n,o){var a;return a={nick:n.uname,lan:r},n.gcode&&(a.payPassword=n.gcode),e.post(t+"user/forgot_password",CORE.j2q(a)).success(function(e){return o(e)}).error(function(e){return o(null,e)})},recoveryBySms:function(n,o){var a;return a={nick:n.uname,verifyCode:n.vcode,newPassword:n.pwd,lan:r},e.post(t+"user/reset_password_phone",CORE.j2q(a)).success(function(e){return o(e)}).error(function(e){return o(null,e)})},resetByEmail:function(n,r,o){var a;return a=CORE.j2q({token:n,newPassword:r}),e.post(t+"user/reset_password_email",a).success(function(e){return o(e)}).error(function(e){return o(null,e)})},userUnlock:function(n,r,o){var a;return n=n||"",a=CORE.j2q({password:r,password_pay:n}),e.post(t+"user/unlock",a).success(function(e){return o(e)}).error(function(e){return o(null,e)})},sendSms:function(n,r,o){var a;return a=CORE.j2q({nick:n,receiveType:r}),e.post(t+"user/send_sms_verify_code?"+a).success(function(e){return o(e)}).error(function(e){return o(null,e)})},sendCloseSMSEmail:function(n){return e.get(t+"user/send_close_dynamic_password_mail?lan="+r).success(function(e){return n(e)}).error(function(e){return n(null,e)})},checkUserUnlock:function(n){return e.get(t+"user/check_unlock").success(function(e){return n(e)}).error(function(e){return n(null,e)})}}}])}),define("services/passport",["common/module","common/locales","jade!tmpl/passport","components/pwd-strength","components/markup","services/pp"],function(e,n,t){var r,o,a,i,s,l;return l=n.get(!0),r="passport",o={login:"登录",signup:"注册"},s=function(e){return o[e]||o.login},i="passportCtrl",a=["$scope","$rootScope","passportServ","$location","$route","ppServ","$timeout","$sce",function(e,n,t,r,a,i,s,l){var c,u,d,p,f,g,m;return e.conf=u={needMobi:!1},d="news.read",f=5,p=CORE.LS.get(d),f>p&&(n.hasNew=!0),n.newsShow=0,n.toggleNewsShow=function(e,t){return t?n.newsShow=0:(n.newsShow=n.newsShow?0:1,p!==f?(CORE.LS.set(d,f),delete n.hasNew):void 0)},e.PP=c=t.PP(),g=r.search(),g.passport&&(c.action=g.passport),e.formData={},e.$watch("PP.action",function(r){if(r&&o[r])return e.apiErr=!1,t.search(r),n.passportName=o[r]}),m=function(e){var o,a,i;return o=r.search(),(a=e.callback||o.callback)?CORE.redirect2(a,1):(i=!0,!i&&e.userInfo.emailNotActivated?(r.search({passport:"activate",email:e.userInfo.email}),void(n.$$phase||n.$apply())):"signup"===c.action?void t.search("login"):o.c?CORE.redirect2(o.c,1):t.inPage()?CORE.redirect2("/",1):(t.search(null),null))},e.login=function(){return e.pending=!0,i.login(e.formData,function(n,t){return e.pending=!1,t?e.apiErr=t:(c.dialog&&c.dialog.close(),m(n))})},e.signup=function(){return e.pending=!0,e.apiErr=!1,i.signup(e.formData,function(n,t){return e.pending=!1,t?e.apiErr=t:(c.dialog&&c.dialog.close(),m(n))})}}],e.factory("passportServ",["$rootScope","$location","$dialog",function(e,n,i){var l,c,u,d;return l={dialog:null,action:null},d=function(t){if(n.search(r,t),!e.$$phase)return e.$apply()},c=function(){return/^\/passport/.test(location.pathname)},e.$on("$locationChangeSuccess",function(e,t,r){var a,i;if(a=n.search().passport){if(a===l.action)return;o[a]||(a="login"),l.action=a,d(l.action)}else if(!(null!=(i=Const.user)?i.enrollId:void 0))return u()}),e.$watch("Const.user.enrollId",function(e){var t;return e?(t=n.search().passport,l.dialog&&"activate"===t?(l.dialog.close(),d(null)):c()&&!~["reset","signup"].indexOf(t)?d("login"):void 0):u()}),e.$on("after-logout",function(){return u()}),u=function(e,r){var o,u;if(o=n.search(),c()&&!o.passport)return d("login");if(Const.loginChecked){if(e){if(l.action===e)return;l.action=e}else if(l.action)return;switch(CORE.pathNeedLogin()){case 1:return CORE.redirect2Login(1);case 0:if(c())return d({passport:l.action});if(r)return CORE.redirect2Login(1);break;case-1:if(null!=(u=l.dialog)?u.show():void 0)return;return l.dialog=i.open({title:s(l.action),classname:"dialog3",template:'<div class="dialogC">'+t+"</div>",controller:a,onClose:function(){return d({passport:null})}})}}},{inPage:c,search:d,PP:function(){return l},open:u,login:function(){return u("login")},signup:function(){return u("signup")},forgot:function(){return u("forgot")},recovery:function(){return u("recovery")}}}]).controller(i,a),{controller:a,tmpl:t,ctrl:i}}),define("components/passport",["common/module","services/passport"],function(e){return e.directive("ngdPassport",["$location","$route","passportServ",function(e,n,t){return{restrict:"A",link:function(e,n,r,o){return n.on("click",function(){return t.open(r.ngdPassport,!0)})}}}])}),define("common/moment",["moment","common/locales"],function(e,n){return e.locale(n.get()),e}),define("components/dpl",["common/module","common/moment","lib/coin"],function(e,n,t){var r,o;return o=[void 0,null,""],r=angular.element,e.directive("ngdSetLang",[function(){return{scope:!0,link:function(e,n,t){var r,o;return r=locales.get(),o=t.ngdSetLang,r===o&&n.addClass("curLang").find("input").attr("checked",!0),n.on("click",function(){var e;return e=n.parent(),o===locales.get()||!e.attr("disabled")&&(e.attr("disabled",!0),locales.set(o),location.reload())})}}}]).directive("ngdAmount",function(){return{require:"?ngModel",restrict:"A",link:function(e,n,r,o){return e.$watch(r.ngdAmount,function(e){return t.prettyAmount(e,r,n)})}}}).directive("ngdFillTrader",["fastServ","$rootScope","$parse",function(e,n,t){var o;return o="focus",{restrict:"A",link:function(a,i,s,l){var c;return c=e.trader(),i.addClass("fuc4"),i.on("click",function(){var e,l;return l=r("#"+o),l.length&&l.removeAttr("id"),i.attr("id",o),e=t(s.ngdFillTrader)(a),n.$broadcast("fill-trader",e)})}}}]).directive("ngdExchagneRate",["$compile",function(e){return{scope:{pair:"=ngdExchagneRate",reverse:"@ngdExchangeRateReverse"},link:function(n,r,o){var a,i;return r.on("click",function(e){if(e.stopPropagation(),angular.element(e.target).hasClass("iF"))return a(!0)}),i="",(a=function(o,a){var s,l,c,u,d;if(l=(null!=(c=n.pair)?c.data:void 0)||n.pair)return o&&!a&&(n.reverse=!n.reverse),d={},u={},d=l.isBuyAll?{currency:l.srcCurrency,amount:l.srcCount}:{currency:l.desCurrency,amount:l.desCount},u=l.isBuyAll?{currency:l.desCurrency,amount:l.desCount}:{currency:l.srcCurrency,amount:l.srcCount},s={sellCurrency:u.currency,buyCurrency:d.currency,price:l.price||new BN(u.amount).div(d.amount).toString()},l.lCurrency=s.sellCurrency,l.lAmount=n.reverse?s.price:1,l.lAmountTxt=n.reverse?t.prettyAmount(l.lAmount,{currency:l.lCurrency}):1,l.rCurrency=s.buyCurrency,l.rAmount=n.reverse?1:new BN(1).div(s.price).toString(),l.rAmountTxt=n.reverse?1:t.prettyAmount(l.rAmount,{currency:l.rCurrency}),i=['<span class="expair">','<span class="amount">'+l.lAmountTxt+"</span>",'<span class="currency">'+l.lCurrency+"</span>",'<i class="iF" style="cursor:pointer;" ng-class="[reverse?\'iF-arrowL3\':\'iF-arrowR3\']"></i>','<span class="amount">'+l.rAmountTxt+"</span>",'<span class="currency">'+l.rCurrency+"</span>","</span>"].join(""),r.html(e(i)(n))})(n.reverse,!0)}}}])}),define("components/base",["./passport","./dpl"],function(){}),define("common/Const",["config","common/module"],function(e,n){var t,r;return r=window,t=[],n.factory("ConstServ",["ajax","$rootScope","$timeout",function(e,n,o){var a,i,s,l,c,u,d,p,f;return a=CORE.api.trade,p="",c=!1,l=function(){var e;if(e=Const.user&&Const.user.enrollId||"",!p&&e&&(p=e),p!==e)return CORE.afterLogout(),!0},u=0,s=function(t){return t||(t=angular.noop),e.get(a+"islogin").success(function(e){var o;return c?location.reload():(Const.loginChecked=1,(o=e.userInfo)?(angular.extend(r.Const.user||(r.Const.user={}),o),t(),1===u&&(n.$emit("reLogined"),n.$$phase||n.$apply()),u=0):t())}).error(function(e){return Const.loginChecked=1,0===u&&(n.$emit("loggedOut"),n.$$phase||n.$apply()),u=1,t(e)})},f=function(){return s(function(e){if(!l()){for(;!e&&t.length;)t.shift()();return o(function(){return setTimeout(f)},1e5)}})},f(),i=function(e,n){var o,a,i,s,l;for(i=e.split("."),l=r.Const,a=0,s=i.length;a<s;a++)if(o=i[a],l=l[o],!l)return t.push(n);return n()},d=function(){return o(function(){return n.viewLoaded=!0})},{await:i,awaitView:function(){return CORE.pathNeedLogin()||d(),n.$on("updateViewLoaded",function(){return d()})}}}])}),define("controllers/base",["common/module","common/Const"],function(e){var n;return n={"/balance":{name:"BALANCE",nick:"余额"},"/issue":{name:"ISSUE",nick:"发行"},"/history":{name:"HISTORY",nick:"历史"},"/trade":{name:"TRADE",nick:"交易"},"/base":{name:"HISTORY",nick:"历史"}},e.controller("appCtrl",["$scope","$location","$route","$rootScope","ConstServ",function(e,t,r,o,a){var i;return e.Const=o.Const=window.Const,i=function(){var a,i,s,l,c,u;a=location.pathname||"/",l=a.split("/"),s=l.slice(0,2).join("/"),i=l.slice(0,3).join("/"),e.Page=o.Page=n[a]||n[i]||n[s]||{},e.Page.search=t.search(),e.Page.path=null!=(c=a.match(/^(\/\w+)+/))?c[0]:void 0,e.Page.params=null!=(u=r.current)?u.params:void 0},e.$on("$routeChangeSuccess",i),e.$on("$routeUpdate",i),a.awaitView()}])}),define("vendor/ngRoute",["angular"],function(e){"use strict";function n(e,n){if(i(e)){n=n||[];for(var t=0,r=e.length;t<r;t++)n[t]=e[t]}else if(s(e)){n=n||{};for(var o in e)"$"===o.charAt(0)&&"$"===o.charAt(1)||(n[o]=e[o])}return n||e}function t(){function t(n,t){return e.extend(Object.create(n),t)}function r(e,n){var t=n.caseInsensitiveMatch,r={originalPath:e,regexp:e},o=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(e,n,t,r){var a="?"===r||"*?"===r?"?":null,i="*"===r||"*?"===r?"*":null;return o.push({name:t,optional:!!a}),n=n||"",""+(a?"":n)+"(?:"+(a?n:"")+(i&&"(.+?)"||"([^/]+)")+(a||"")+")"+(a||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",t?"i":""),r}i=e.isArray,s=e.isObject;var o={};this.when=function(t,a){var i=n(a);if(e.isUndefined(i.reloadOnSearch)&&(i.reloadOnSearch=!0),e.isUndefined(i.caseInsensitiveMatch)&&(i.caseInsensitiveMatch=this.caseInsensitiveMatch),o[t]=e.extend(i,t&&r(t,i)),t){var s="/"==t[t.length-1]?t.substr(0,t.length-1):t+"/";o[s]=e.extend({redirectTo:t},r(s,i))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(e){return"string"==typeof e&&(e={redirectTo:e}),this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function(n,r,a,i,s,l,u){function d(e,n){var t=n.keys,r={};if(!n.regexp)return null;var o=n.regexp.exec(e);if(!o)return null;for(var a=1,i=o.length;a<i;++a){var s=t[a-1],l=o[a];s&&l&&(r[s.name]=l)}return r}function p(t){var r=w.current;y=h(),C=y&&r&&y.$$route===r.$$route&&e.equals(y.pathParams,r.pathParams)&&!y.reloadOnSearch&&!b,C||!r&&!y||n.$broadcast("$routeChangeStart",y,r).defaultPrevented&&t&&t.preventDefault()}function f(){var t=w.current,o=y;C?(t.params=o.params,e.copy(t.params,a),n.$broadcast("$routeUpdate",t)):(o||t)&&(b=!1,w.current=o,o&&o.redirectTo&&(e.isString(o.redirectTo)?r.path(v(o.redirectTo,o.params)).search(o.params).replace():r.url(o.redirectTo(o.pathParams,r.path(),r.search())).replace()),i.when(o).then(g).then(function(r){o==w.current&&(o&&(o.locals=r,e.copy(o.params,a)),n.$broadcast("$routeChangeSuccess",o,t))},function(e){o==w.current&&n.$broadcast("$routeChangeError",o,t,e)}))}function g(n){if(n){var t=e.extend({},n.resolve);e.forEach(t,function(n,r){t[r]=e.isString(n)?s.get(n):s.invoke(n,null,null,r)});var r=m(n);return e.isDefined(r)&&(t.$template=r),i.all(t)}}function m(n){var t,r;return e.isDefined(t=n.template)?e.isFunction(t)&&(t=t(n.params)):e.isDefined(r=n.templateUrl)&&(e.isFunction(r)&&(r=r(n.params)),e.isDefined(r)&&(n.loadedTemplateUrl=u.valueOf(r),t=l(r))),t}function h(){var n,a;return e.forEach(o,function(o,i){!a&&(n=d(r.path(),o))&&(a=t(o,{params:e.extend({},r.search(),n),pathParams:n}),a.$$route=o)}),a||o[null]&&t(o[null],{params:{},pathParams:{}})}function v(n,t){var r=[];return e.forEach((n||"").split(":"),function(e,n){if(0===n)r.push(e);else{var o=e.match(/(\w+)(?:[?*])?(.*)/),a=o[1];r.push(t[a]),r.push(o[2]||""),delete t[a]}}),r.join("")}var y,C,b=!1,w={routes:o,reload:function(){b=!0;var e={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,b=!1}};n.$evalAsync(function(){p(e),e.defaultPrevented||f()})},updateParams:function(n){if(!this.current||!this.current.$$route)throw c("norout","Tried updating route when with no current route");n=e.extend({},this.current.params,n),r.path(v(this.current.$$route.originalPath,n)),r.search(n)}};return n.$on("$locationChangeStart",p),n.$on("$locationChangeSuccess",f),w}]}function r(){this.$get=function(){return{}}}function o(n,t,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(o,a,i,s,l){function c(){f&&(r.cancel(f),f=null),d&&(d.$destroy(),d=null),p&&(f=r.leave(p),f.then(function(){f=null}),p=null)}function u(){var i=n.current&&n.current.locals,s=i&&i.$template;if(e.isDefined(s)){var u=o.$new(),f=n.current,h=l(u,function(n){r.enter(n,null,p||a).then(function(){!e.isDefined(g)||g&&!o.$eval(g)||t()}),c()});p=h,d=f.scope=u,d.$emit("$viewContentLoaded"),d.$eval(m)}else c()}var d,p,f,g=i.autoscroll,m=i.onload||"";o.$on("$routeChangeSuccess",u),u()}}}function a(e,n,t){return{restrict:"ECA",priority:-400,link:function(r,o){var a=t.current,i=a.locals;o.html(i.$template);var s=e(o.contents());if(a.controller){i.$scope=r;var l=n(a.controller,i);a.controllerAs&&(r[a.controllerAs]=l),o.data("$ngControllerController",l),o.children().data("$ngControllerController",l)}r[a.resolveAs||"$resolve"]=i,s(r)}}}var i,s,l=e.module("ngRoute",["ng"]).provider("$route",t),c=e.$$minErr("ngRoute");l.provider("$routeParams",r),l.directive("ngView",o),l.directive("ngView",a),o.$inject=["$route","$anchorScroll","$animate"],a.$inject=["$compile","$controller","$route"]}),define("vendor/ngPushState",["angular","./ngRoute"],function(e){e.module("ngPushState",[]).run(["$route","$rootScope","$location","$timeout",function(e,n,t,r){t.pushState=function(r,o){var a=e.current,i=a.$$route,s=n.$on("$locationChangeSuccess",function(){var t=e.current,r=t.$$route;r.keys.length&&a&&i.controller==r.controller&&i.templateUrl==r.templateUrl&&(e.current=a,n.$broadcast("$routeUpdate",t)),s()});t.path(r),o||t.replace()}}])}),require(["config","angular","services/passport","components/base","controllers/base","vendor/ngRoute","vendor/ngPushState"],function(e,n,t){var r;return r="passport",n.module(r,["CORE","ngRoute","ngPushState"]).config(["$routeProvider","$locationProvider","$compileProvider",function(e,n,r){return r.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|javascript|chrome-extension|bitcoin):/),n.html5Mode(!0),e.when("/",{template:t.tmpl,controller:t.ctrl,reloadOnSearch:!1}).otherwise("/")}]),n.element().ready(function(){return n.bootstrap(document.documentElement,[r])})}),define("app/passport",function(){});